#!/usr/bin/env bash
set -euo pipefail

m4 \
  -D DEVICE=/dev/sda \
  -D HOSTNAME=arch-setup \
  <config.json.in \
  >config.json

m4 \
  -D DISK_PASSWORD=testing_disk \
  -D ROOT_PASSWORD=testing_root \
  -D USERNAME=patrick \
  -D PASSWORD=testing \
  <creds.json.in \
  >creds.json

archinstall --config config.json --creds creds.json

# config.json
#   network_config
#   packages
#     +packages
#     +aur-packages
#     base-devel
#     grml-zsh-config
#     intel-ucode
#     neovim
#     sudo
#     xf86-video-nouveau
#     zsh
#
# chsh -s /bin/zsh
#
# curl_file acpi-handler.sh | sudo tee /etc/acpi/handler.sh
# systemctl enable acpid
# systemctl enable laptop-mode
#
# pip install cfn-flip

# GPG & Passwords?
